@page "/category/edit/{categoryId:int}"
@inject HttpClient http
@inject NavigationManager navigation

<h2>Edit Category</h2>

<EditForm Model="@category" OnValidSubmit="@EditCategory" >
	<DataAnnotationsValidator />
	<ValidationSummary />

	<div class="form-group">
		<label for="name">Name</label>
		<div>
			<InputText @bind-Value="@category.Name" class="form-control" />
			<ValidationMessage For="@(() => category.Name)" />
		</div>
	</div>
	<div class="form-group">
		<label for="name">Description</label>
		<div>
			<InputText @bind-Value="@category.Description" class="form-control" />
			<ValidationMessage For="@(() => category.Description)" />
		</div>
	</div>
	
	<div class="custom-top">
		<button type="submit" class="btn btn-success">Edit</button>
		<button class="btn btn-danger" @onclick="@(() => navigation.NavigateTo("category"))">Cancel</button>
	</div>
</EditForm>

@code {
	[Parameter]
	public int categoryId { get; set; }

	Category category = new Category();

	protected async override Task OnParametersSetAsync()
	{
		category = await http.GetFromJsonAsync<Category>($"api/category/{categoryId}");
	}

	async Task EditCategory()
	{
		await http.PutAsJsonAsync("api/category", category);
		navigation.NavigateTo("category");
	}
}
